# FastVoice 调试测试指南

## 🎯 目的
通过运行日志诊断"注入不成功"问题的真正原因

## 📋 测试步骤

### 步骤 1：启动应用
```bash
cd /Users/wangchengliang/Documents/claude/fastvoice
./run.sh
```

### 步骤 2：触发语音输入
1. 打开 TextEdit 或其他文本编辑器
2. 将光标定位到文本编辑器中
3. 按下快捷键（默认是 Option 键）
4. 说一句简短的话（如"测试"）
5. 释放快捷键

### 步骤 3：观察结果
- **如果文字成功出现**：记下"成功"，继续步骤 4
- **如果文字没有出现**：记下"失败"，继续步骤 4

### 步骤 4：退出应用
- 点击托盘图标 → 退出
- 或者直接关闭终端窗口

### 步骤 5：收集日志
```bash
# 日志文件位置
tail -100 logs/fastvoice.log
```

---

## 🔍 关键日志标识

### 正常成功的日志流程
```
🔍 [DEBUG] inject() 被调用，文本: '测试...'
📝 [TextInjector] 开始注入文字: '测试...'
📋 [MacOSInjector] 开始剪贴板粘贴流程
✅ [MacOSInjector] 粘贴成功
```

### 失败的日志流程
```
🔍 [DEBUG] inject() 被调用，文本: '测试...'
📝 [TextInjector] 开始注入文字: '测试...'
📋 [MacOSInjector] 开始剪贴板粘贴流程
✗ [MacOSInjector] 剪贴板冲突，多次重试后仍失败
```

---

## 📊 需要的信息

### 1. inject() 是否被调用？
搜索日志中是否有 `🔍 [DEBUG] inject() 被调用`

### 2. 调用后发生了什么？
搜索 `📝 [TextInjector] 开始注入文字` 后面的日志

### 3. 是否有错误？
搜索日志中包含 `✗` 或 `ERROR` 的行

### 4. 剪贴板是否正确设置？
搜索日志中的 `剪贴板` 关键词

---

## 📤 请提供

请提供以下日志内容（从触发语音输入到退出的完整日志）：

```bash
# 获取最近的 200 行日志
tail -200 logs/fastvoice.log
```

或者，如果日志太长，请提供包含以下关键词的行：
- `🔍 [DEBUG] inject()`
- `📝 [TextInjector]`
- `📋 [MacOSInjector]`
- `✗` 或 `ERROR`

---

## 💡 常见问题

### Q: 我看不到日志文件
A: 日志应该在 `logs/fastvoice.log`，如果不存在，请检查配置

### Q: 日志太多了
A: 只需要提供从"按下快捷键"到"退出"这段时间的日志即可

### Q: 我不确定是否成功注入了
A: 文字是否出现在你打开的文本编辑器中？如果出现了就是成功，没出现就是失败

---

请按照这个指南测试，然后把日志发给我，我会分析真正的问题！
